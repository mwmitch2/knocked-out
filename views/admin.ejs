<%- include('./partials/head') %>
    <%- include('./partials/header') %>

        <body>
            <div class="container mt-5">
                <h2 class="center">Individual Teams</h2>
                <input class="form-control" id="team-search" type="text" placeholder="Search...">
                <div class="mt-3">

                    <ul class="list-group" id="list-container">
                        <% teams.forEach(function(team) { %>
                            <li class="list-group-item p-3 team-listItem" id="<%= team.teamName %>-listItem"><span
                                    class="middle">
                                    <%= team.teamName %>
                                </span>
                                <button type="button" id="<%= team.teamName %>-btn"
                                    class="btn btn-outline-danger float-end deleteBtn" data-bs-toggle="modal"
                                    data-bs-target="#deleteModal" value="<%= team.teamName %>"
                                    onclick="executeModal(this)">Delete</button>
                            </li>
                            <% }) %>
                    </ul>
                </div>

            </div>

            <!-- sets team name for modal delete confirmation popup and for form input value -->
            <script type="text/javascript">
                function executeModal(element) {
                    var name = element.value;
                    $('#confirm-delete-msg').html(`Are you sure you want to delete team <span class="text-danger">${name}</span>? This action cannot be undone.`);
                    $('#modal-teamName').val(name);
                }
            </script>

            <!-- filters teams based on term in search bar -->
            <script type="text/javascript">
                $(function () {
                    $('#team-search').on('keyup', function () {
                        var searchterm = $(this).val().toLowerCase();
                        $('.team-listItem').filter(function () {
                            $(this).toggle($(this).text().toLowerCase().indexOf(searchterm) > -1)
                        });
                    });
                });
            </script>

            <form action="/admin" method="post">
                <!-- Modal -->
                <div class="modal fade" id="deleteModal" data-bs-backdrop="static" data-bs-keyboard="false"
                    tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="deleteModalLabel">Delete Confirmation</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body" id="modal-body">
                                <h8 id="confirm-delete-msg">
                                    <!-- Are you sure you want to delete team someTeam? This action cannot be undone. -->
                                </h8>
                            </div>
                            <div class="modal-footer">
                                <input type="hidden" id="modal-teamName" name="teamName" value="">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-danger" id="delete-confirm-btn">Delete</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>


            <link rel="stylesheet" href="/stylesheets/admin.css">
        </body>

        <%- include('./partials/footer') %>